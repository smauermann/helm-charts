# -- Application name used in resource naming (required)
# Example: "mealie", "pocket-id", "jellyfin"
appName: ""

# -- ArgoCD Sync Wave to ensure volume is populated before app is created
# Examples: "-100", "42"
# Default: 5Gi
argoSyncWave: "-100"

backup:
  # -- Name of the source PVC (required)
  pvcName: ""

  # -- Backup trigger, either schedule or manual trigger
  trigger:
    # -- Backup schedule in cron format
    # Default: Daily at 1:00 AM
    # Examples: "0 2 * * *" (2 AM daily), "0 1 * * 0" (1 AM Sundays only)
    schedule: "0 1 * * *"
    # -- Manual trigger name for backup operation
    # Change this value to trigger a new backup
    # Example: "backup-2024-01-15", "emergency-backup"
    manual: ~

  retain:
    # -- Number of hourly backups to keep
    hourly: 0
    # -- Number of daily backups to keep
    daily: 7
    # -- Number of weekly backups to keep
    weekly: 4

  # -- How often to run backup pruning (in days)
  pruneIntervalDays: 7

  # -- Size of restic cache volume
  # Examples: "1Gi", "2Gi", "512Mi"
  cacheCapacity: 2Gi

  # -- Storage class for backup cache volumes
  cacheStorageClass: longhorn-single-replica

  # -- Storage class for  volumes
  storageClass: longhorn

  # -- Volume snapshot class for creating PVC snapshots
  volumeSnapshotClass: longhorn-snapshot

# Restore configuration
restore:
  # -- Enable restore functionality (creates ReplicationDestination)
  enabled: false

  # -- Name of the destination PVC
  # Defaults to source PVC name
  pvcName: ""

  # -- Size of the restored volume (required)
  pvcSize: ""

  # -- Access modes for the destination volume
  accessModes:
    - ReadWriteOnce

  # -- Storage class for destination volumes used during restore
  # Defaults to source volume storageClass if omitted
  storageClass: ""

  # -- Enable file deletion during restore
  # If true, files and directories that exist on the PVC being restored to
  # will be deleted if they do not exist in the restic snapshot being restored
  # Default: false
  enableFileDeletion: true

  # -- Restore data from a specific point in time (RFC-3339 timestamp)
  # If not specified, restores from the most recent backup
  # Example: "2024-01-15T10:30:00Z"
  restoreAsOf: ""

  # -- Manual trigger name for restore operation
  # Change this value to trigger a new restore
  # Example: "restore-2024-01-15", "emergency-restore"
  trigger: "restore"

  # -- Enable cache PVC deletion
  # If true, restic cache PVC are deleted at the end of each restore. Cache PVCs will be always be deleted if the owning ReplicationDestination is removed.
  # Should be disabled when using longhorn https://github.com/backube/volsync/issues/1504
  # Default: false
  cleanupCachePVC: false

  # -- Enable temporary PVC deletion
  # If true, delete the temporary destination PVC. No effect when `destinationPVC` is defined.
  # Should be disabled when using longhorn https://github.com/backube/volsync/issues/1504
  # Default: false
  cleanupTempPVC: false

  # -- Size of restic cache volume
  # Defaults to backup cache size
  cacheCapacity: ""

  # -- Storage class for backup cache volumes
  # Defaults to backup cache storageClass
  cacheStorageClass: ""

# Restic security context configuration
restic:
  # -- User ID to run restic process as
  runAsUser: 65534
  # -- Group ID to run restic process as
  runAsGroup: 65534
  # -- File system group for restic volumes
  fsGroup: 65534

# Backblaze B2 configuration via External Secrets
s3:
  provider: b2
  secretStoreRef:
    # -- Type of secret store (SecretStore or ClusterSecretStore)
    kind: ClusterSecretStore
    # -- Name of the secret store containing B2 credentials
    name: onepassword-connect
  # -- Key in secret store containing B2 credentials
  # The secret should contain: RESTIC_PASSWORD, AWS_ACCESS_KEY_ID,
  # AWS_SECRET_ACCESS_KEY, AWS_DEFAULT_REGION, AWS_S3_ENDPOINT, BUCKET_NAME
  secretKey: backblaze-volsync
